# LLM アプリ開発 & LLMOps コース

本リポジトリを使用した LLM アプリケーションの構築と LLMOps 実践の適用に関する包括的なコースへようこそ。このコースは、完全な初心者から上級者まで、さまざまなスキルレベルの開発者向けに設計されています。

## コース概要

このコースは 4 つのモジュールで構成されており、各モジュールは前のモジュールを基礎としています。各モジュールは段階的に以下を教えるように設計されています:

1. **環境セットアップ** - コードベースの開始方法
2. **エージェント開発** - LLM エージェントの構築とカスタマイズ
3. **セキュリティ実践** - ガードレールと安全対策の実装
4. **評価と運用** - 体系的なテストと監視

## 対象ペルソナ

このコースは 3 つの異なるペルソナに対応しています:

### ペルソナ 1: LLM アプリの初級者

**前提条件:** 基本的な TypeScript/JavaScript の知識、コマンドラインの使用経験

**学習パス:**

- [モジュール 01: 環境セットアップ](./01_setup.md) から開始
- [モジュール 02: 初級エージェント](./02_beginner_agents.md) へ進む
- 基本的なエージェントの概念とプロンプトエンジニアリングの理解に焦点を当てる

**学ぶこと:**

- LLM アプリケーションの起動と実行方法
- システム指示によるエージェントの振る舞いのカスタマイズ方法
- 特定のユースケースに向けたエージェントロジックの変更方法
- カスタムツールの実装方法と構造化出力の扱い方
- `createAgent` を使用した ReAct エージェントの構築方法
- 変更のテスト方法

**変更する主要ファイル:**

- `packages/agents/src/agents/default_agent/defaultAgentNodes.ts`
- `packages/agents/src/agents/research_agent/researchAgentNodes.ts`

### ペルソナ 2: 中級 LLM アプリ開発者

**前提条件:** ペルソナ 1 のモジュール完了、基本的な LLM の概念の理解

**学習パス:**

- [モジュール 01: 環境セットアップ](./01_setup.md) を完了 (未完了の場合)
- [モジュール 02: 初級エージェント](./02_beginner_agents.md) を完了 (未完了の場合)
- [モジュール 03: 中級セキュリティ](./03_intermediate_security.md) へ進む

**学ぶこと:**

- LLM セキュリティのための「サンドイッチアーキテクチャ」
- 入力サニタイズの実装方法
- 出力サニタイズの実装方法
- プロンプトインジェクションとデータ漏洩の防止方法
- セキュリティガードレールのテスト方法

**変更する主要ファイル:**

- `packages/agents/src/agents/secure_agent/subagents/input_sanitizer/inputSanitizerNodes.ts`
- `packages/agents/src/agents/secure_agent/subagents/output_sanitizer/outputSanitizerNodes.ts`

### ペルソナ 3: 上級 LLM アプリ開発者

**前提条件:** ペルソナ 2 のモジュール完了、LLM セキュリティ概念の理解

**学習パス:**

- 前のモジュールを完了 (未完了の場合)
- [モジュール 04: 上級評価](./04_advanced_evaluation.md) へ進む

**学ぶこと:**

- LLM-as-a-Judge 評価手法
- 評価データセットの作成と管理方法
- カスタム評価器の定義方法
- 体系的なオフライン評価の実行方法
- 敵対的テスト（レッドチーミング）の実施方法
- 結果の解釈と改善の反復方法

**変更する主要ファイル:**

- `packages/agents/src/agents/secure_agent/subagents/*/eval/langsmith/llm_judge/dataset.ts`
- `packages/agents/src/agents/secure_agent/subagents/*/eval/langsmith/llm_judge/evaluator.ts`
- `packages/agents/src/agents/secure_agent/subagents/*/eval/langsmith/llm_judge/runEvaluation.ts`

## コースモジュール

### [モジュール 01: 環境セットアップ](./01_setup.md)

**対象:** 全てのペルソナ
**所要時間:** 30-45 分

開発環境のセットアップ、API キーの設定、完全なアプリケーションスタック（フロントエンド + バックエンド + エージェント）の起動方法を学びます。

**トピック:**

- 前提条件とインストール
- 環境変数の設定
- プロジェクトのビルド
- バックエンドとフロントエンドサーバーの起動
- 確認とトラブルシューティング

**成果:** ローカルで動作する LLM アプリケーション環境が整います。

---

### [モジュール 02: 初級エージェント - 初めての LLM エージェント](./02_beginner_agents.md)

**対象:** ペルソナ 1 (初級者)
**所要時間:** 2-3 時間

既存のエージェントを変更することで、LLM アプリケーション開発の基礎を学びます。システム指示がどのように振る舞いを制御するか、エージェントロジックをどのようにカスタマイズするかを理解します。

**トピック:**

- システム指示と役割
- エージェントペルソナのカスタマイズ
- リサーチロジックの強化
- カスタムツールの実装（関数呼び出し）
- 構造化出力（JSON）の操作
- `createAgent` を使用した ReAct エージェントの構築
- エージェント状態の理解
- 変更のテスト

**ハンズオン演習:**

- Default Agent を海賊ペルソナに変身させる
- Research Agent に最小検索クエリ数を強制する
- 電卓ツールを実装する
- ユーザー情報を JSON として抽出する
- スタンドアロンの ReAct エージェントスクリプトを構築する
- メッセージウィンドウサイズを変更する
- カスタム状態フィールドを追加する

**成果:** エージェントの振る舞いをカスタマイズし、ツールを実装し、基本的なエージェントアーキテクチャを理解できるようになります。

---

### [モジュール 03: 中級セキュリティ - セキュアな LLM アプリの構築](./03_intermediate_security.md)

**対象:** ペルソナ 2 (中級者)
**所要時間:** 3-4 時間

「サンドイッチアーキテクチャ」パターン（入力ガード → LLM → 出力ガード）を使用して、LLM アプリケーションのセキュリティガードレールを実装する方法を学びます。

**トピック:**

- サンドイッチアーキテクチャの理解
- 入力サニタイズ技術
- 出力サニタイズ技術
- プロンプトインジェクションの防止
- データ漏洩の防止
- セキュリティガードレールのテスト

**ハンズオン演習:**

- 入力サニタイザーで競合他社の言及をブロックする
- PII リクエストをブロックする
- 出力サニタイザーでメールアドレスをリダクションする
- 内部 ID をリダクションする
- API キー漏洩を防ぐ

**成果:** LLM アプリケーションのための堅牢なセキュリティガードレールを実装できるようになります。

---

### [モジュール 04: 上級評価 - LLM 評価と運用](./04_advanced_evaluation.md)

**対象:** ペルソナ 3 (上級者)
**所要時間:** 4-5 時間

LangSmith の評価フレームワークを使用して LLM アプリケーションを体系的に評価する方法を学びます。「vibe checks」からデータ主導の評価へ移行します。

**トピック:**

- LLM-as-a-Judge 評価手法
- 評価データセットの作成と管理
- カスタム評価器の定義
- 体系的な評価の実行
- 敵対的テスト（レッドチーミング）
- 結果の解釈と反復

**ハンズオン演習:**

- 既存の評価を実行する
- データセットにエッジケースを追加する
- カスタム評価器を作成する（トーンチェック、応答時間）
- 複合評価器を作成する
- LLM を使用して敵対的攻撃を生成する
- 発見された脆弱性に対する防御を実装する

**成果:** LLM アプリケーションを体系的に評価し、レッドチーミングを行い、データに基づいた改善を行えるようになります。

## クイックスタートガイド

### 完全な初心者の方

1. **ここからスタート:** [モジュール 01: 環境セットアップ](./01_setup.md)
   - 環境を整える
   - 全てが動作することを確認する

2. **次へ:** [モジュール 02: 初級エージェント](./02_beginner_agents.md)
   - エージェント開発の基礎を学ぶ
   - 最初のエージェントを変更する

3. **学習を続ける:**
   - モジュール 02 に慣れたら、モジュール 03 に進む
   - 各演習に時間をかける
   - 例を超えて実験する

### 経験豊富な開発者の方

1. **クイックセットアップ:** [モジュール 01: 環境セットアップ](./01_setup.md)
   - スタックに精通している場合はスキップ可能

2. **レベルに合わせてジャンプ:**
   - **LLM セキュリティは初めて？** → [モジュール 03: 中級セキュリティ](./03_intermediate_security.md)
   - **セキュリティには詳しい？** → [モジュール 04: 上級評価](./04_advanced_evaluation.md)

3. **必要に応じて参照:**
   - エージェントアーキテクチャについてはモジュール 02 を参照
   - セキュリティパターンについてはモジュール 03 を参照

## コース構造

```text
docs/projects/ja/
├── README.md (このファイル)
├── 01_setup.md (共通 - 全ペルソナ)
├── 02_beginner_agents.md (ペルソナ 1)
├── 03_intermediate_security.md (ペルソナ 2)
└── 04_advanced_evaluation.md (ペルソナ 3)
```

## モジュール別前提条件

| モジュール    | 前提条件                                                          |
| ------------- | ----------------------------------------------------------------- |
| モジュール 01 | Node.js v20+, pnpm, Google Cloud/Gemini API キー                  |
| モジュール 02 | モジュール 01, 基本的な TypeScript/JavaScript                     |
| モジュール 03 | モジュール 01, モジュール 02, 基本的な LLM の概念                 |
| モジュール 04 | モジュール 01, モジュール 02, モジュール 03, LangSmith アカウント |

## 学習リソース

### ドキュメント

- [プロジェクト README](../../../README.md) - プロジェクト全体の概要
- [Default Agent README](../../../packages/agents/src/agents/default_agent/README.ja.md)
- [Research Agent README](../../../packages/agents/src/agents/research_agent/README.ja.md)
- [Secure Agent README](../../../packages/agents/src/agents/secure_agent/README.ja.md)

### 外部リソース

- [LangGraph ドキュメント](https://langchain-ai.github.io/langgraphjs/) - グラフベースのエージェントワークフロー
- [Google Gemini API ドキュメント](https://ai.google.dev/gemini-api/docs) - モデルの機能
- [LangSmith ドキュメント](https://docs.smith.langchain.com/) - 可観測性と評価
- [OWASP LLM Top 10](https://owasp.org/www-project-top-10-for-large-language-model-applications/) - セキュリティベストプラクティス

## ヘルプを得る

### 一般的な問題

1. **ビルドエラー:** ルートディレクトリから `pnpm build` を実行し、TypeScript エラーを確認
2. **API エラー:** `.env` ファイルに正しい API キーがあるか確認
3. **ポート競合:** ポート 3000 (backend) または 4200 (frontend) が使用中か確認
4. **評価エラー:** LangSmith API キーが設定され有効であることを確認

### トラブルシューティング

各モジュールにはトラブルシューティングセクションが含まれています。問題が発生した場合:

1. モジュールのトラブルシューティングセクションを確認
2. コンソール/ログのエラーメッセージを確認
3. 前提条件が満たされているか確認
4. 一般的な問題についてはプロジェクトのメイン README を確認

## コース完了

### ペルソナ 1 (初級者)

**完了基準:**

- [ ] アプリケーションを正常に起動した (モジュール 01)
- [ ] Default Agent のペルソナを変更した (モジュール 02)
- [ ] Research Agent のクエリロジックを変更した (モジュール 02)
- [ ] カスタムツールを実装した (モジュール 02)
- [ ] 構造化出力を使用した (モジュール 02)
- [ ] 基本的な ReAct エージェントを構築した (モジュール 02)
- [ ] エージェントの状態とワークフローを理解した

**次のステップ:**

- さらなるエージェントのカスタマイズを実験する
- 準備ができたらモジュール 03 に進む

### ペルソナ 2 (中級者)

**完了基準:**

- [ ] ペルソナ 1 の基準を完了した
- [ ] 入力サニタイズルールを実装した (モジュール 03)
- [ ] 出力サニタイズルールを実装した (モジュール 03)
- [ ] セキュリティガードレールを効果的にテストした

**次のステップ:**

- さらなるセキュリティルールを追加する
- モジュール 04 に進み、評価について学ぶ

### ペルソナ 3 (上級者)

**完了基準:**

- [ ] ペルソナ 2 の基準を完了した
- [ ] カスタム評価データセットを作成した (モジュール 04)
- [ ] カスタム評価器を定義した (モジュール 04)
- [ ] 体系的な評価を実行した (モジュール 04)
- [ ] 敵対的テストを実施した (モジュール 04)
- [ ] 結果を解釈し、反復した (モジュール 04)

**次のステップ:**

- 本番環境での継続的な評価を設定する
- より多くの例でデータセットを拡張する
- 評価を CI/CD パイプラインに統合する

## 貢献

問題を見つけた場合や、コース改善の提案がある場合は:

1. リポジトリの既存の issue を確認する
2. 詳細を含む新しい issue を作成する
3. または改善を含むプルリクエストを送信する

## ライセンス

このコース教材は LLMOps Demo TypeScript プロジェクトの一部です。詳細はメインプロジェクトの LICENSE ファイルを参照してください。

---

**Happy Learning!** 🚀

[モジュール 01: 環境セットアップ](./01_setup.md) から LLM アプリケーション開発の旅を始めましょう。
